function t_videoPlayer__init(e,t){return"mp4"===t||"webm"===t?t_video__initPlayer__htmlVideo(e,t):"rutube"===t?t_video__initPlayer__rutube(e):"vkvideo"===t?t_video__initPlayer__vkvideo(e):"youtube"===t?t_video__initPlayer__youtube(e):"vimeo"===t?t_video__initPlayer__vimeo(e):"kinescope"===t?t_video__initPlayer__kinescope(e):"boomstream"===t?t_video__initPlayer__boomstream(e):(console.warn("unsupported video type:",t),Promise.reject(null))}function t_video__doRutubeCommand(e,t){e.contentWindow.postMessage(JSON.stringify({type:"player:"+t,data:{}}),"*")}function t_video__doVimeoCommand(e,t){e.contentWindow.postMessage(JSON.stringify({method:t,value:"true"}),"*")}function t_video__doBoomstreamCommand(e,t,o){e.contentWindow.postMessage({code:o,method:"action",action:t,data:""},"*")}function t_video__getPlayer(e){var t;return e.TildaVideoPlayer||null}function t_video__initPlayer__youtube(e){var t="youtube";return new Promise((function(o,i){var n=e.querySelector("iframe");if(!n)return i(new Error(t+": IFrame Element not Found"));t_onFuncLoad("t_loadJsFile",(function(){t_loadJsFile("https://www.youtube.com/iframe_api")})),t_onFuncLoad("YT",(function(){var i=n.id;if(!YT.Player)return setTimeout((function(){t_video__initPlayer__youtube(e).then(o)}),300);var r=new YT.Player(i,{events:{onReady:function i(r){var a=r.target,u={videoType:t,pause:function e(){return a.pauseVideo()},play:function e(){return a.playVideo()},mute:function e(){return console.warn(t+" Mute is not implemented")},unmute:function e(){return console.warn(t+" Unmute is not implemented")},videoEl:n,player:a};return e.TildaVideoPlayer=u,o(u)}}})}))}))}function t_video__initPlayer__vimeo(e){var t="vimeo";return new Promise((function(o,i){var n=e.querySelector("iframe");if(!n)return i(new Error(t+": IFrame Element not Found"));var r={pause:function e(){return t_video__doVimeoCommand(n,"pause")},play:function e(){return t_video__doVimeoCommand(n,"play")},mute:function e(){return console.warn(t+" Mute is not implemented")},unmute:function e(){return console.warn(t+" Unmute is not implemented")},videoEl:n,videoType:t};e.TildaVideoPlayer=r,o(r)}))}function t_video__initPlayer__kinescope(e){var t="kinescope";return new Promise((function(o,i){var n=e.querySelector("iframe");if(!n)return i(new Error(t+": IFrame Element not Found"));t_onFuncLoad("t_loadJsFile",(function(){t_loadJsFile("https://player.kinescope.io/latest/iframe.player.js")})),t_onFuncLoad("Kinescope",(function(){var i=n.id,r=n.src;Kinescope.IframePlayer.create(i,{url:r}).then((function(i){var r={pause:function e(){return i.pause()},play:function e(){return i.play()},mute:function e(){return console.warn(t+" Mute is not implemented")},unmute:function e(){return console.warn(t+" Unmute is not implemented")},player:i,videoEl:n,videoType:t};e.TildaVideoPlayer=r,o(r)}))}))}))}function t_video__initPlayer__vkvideo(e){var t="vkvideo";return new Promise((function(o,i){var n=e.querySelector("iframe");if(!n)return i(new Error(t+": IFrame Element not Found"));t_onFuncLoad("t_loadJsFile",(function(){t_loadJsFile("https://vk.com/js/api/videoplayer.js")})),t_onFuncLoad("VK",(function(){var i=VK.VideoPlayer(n),r={videoType:t,pause:function e(){return i.pause()},play:function e(){return i.play()},mute:function e(){return i.mute()},unmute:function e(){return i.unmute()},videoEl:n,player:i};return e.TildaVideoPlayer=r,o(r)}))}))}function t_video__initPlayer__rutube(e){var t="rutube";return new Promise((function(o,i){var n=e.querySelector("iframe");if(!n)return i(new Error(t+": IFrame Element not Found"));var r={videoType:t,pause:function e(){return t_video__doRutubeCommand(n,"pause")},play:function e(){return t_video__doRutubeCommand(n,"play")},mute:function e(){return console.warn(t+" Mute is not implemented")},unmute:function e(){return console.warn(t+" Unmute is not implemented")},videoEl:n};return e.TildaVideoPlayer=r,o(r)}))}function t_video__initPlayer__htmlVideo(e,t){return new Promise((function(o,i){var n=e.querySelector("video");if(!n)return i(new Error(t+": Video Element not Found"));var r={videoType:t,pause:function e(){return n.pause()},play:function e(){return n.play()},mute:function e(){return console.warn(t+" Mute is not implemented")},unmute:function e(){return console.warn(t+" Unmute is not implemented")},videoEl:n};return e.TildaVideoPlayer=r,o(r)}))}function t_video__initPlayer__boomstream(e){var t="boomstream";return new Promise((function(o,i){var n=e.querySelector("iframe");if(!n)return i(new Error(t+": IFrame Element not Found"));var r,a=/boomstream.com\/(?:balancer\/)?([A-Za-z0-9-]+)/,u=n.src.match(a);if(!u)return i(new Error(t+": VideoID not Found"));var d={pause:function e(){return t_video__doBoomstreamCommand(n,"pause",u[1])},play:function e(){return t_video__doBoomstreamCommand(n,"play",u[1])},mute:function e(){return console.warn(t+" Mute is not implemented")},unmute:function e(){return console.warn(t+" Unmute is not implemented")},videoEl:n,videoType:t};return e.TildaVideoPlayer=d,o(d)}))}function t396_initVideo(e){var t=e.querySelector(".tn-atom__videoiframe"),o=e.querySelector(".tn-atom");if(o&&t&&!t.querySelector("iframe, video")){o.style.backgroundColor="#000";var i=document.getElementById("allrecords"),n=e?e.closest(".r"):null,r={recid:n?n.id.replace("rec",""):"",elementID:e.getAttribute("data-elem-id")||"",hasCover:"y"===o.getAttribute("data-atom-video-has-cover"),hasAutoplay:"y"===t396_elem__getFieldValue(e,"autoplay"),hasInfo:"y"===t396_elem__getFieldValue(e,"showinfo"),hasLoop:"y"===t396_elem__getFieldValue(e,"loop"),isMuted:"y"===t396_elem__getFieldValue(e,"mute"),startSec:t396_elem__getFieldValue(e,"startsec")||"",endSec:t396_elem__getFieldValue(e,"endsec")||"",vimeoHash:t.getAttribute("data-vimeohash")||"",hiddenControls:"hidden"===t.getAttribute("data-video-controls"),isCoverFit:"cover"===t.getAttribute("data-video-object-fit"),isEditMode:!!i&&"edit"===i.getAttribute("data-tilda-mode"),isLazy:"y"===window.lazy},a,u="",d;document.createElement("script").textContent='lazyload_iframe = new LazyLoad({elements_selector: ".t-iframe"});';var s=t.getAttribute("data-youtubeid"),l=t.getAttribute("data-vimeoid"),_=t.getAttribute("data-mp4video"),c=t.getAttribute("data-vkvideoid"),m=t.getAttribute("data-rutubeid"),v=t.getAttribute("data-kinescopeid"),p=t.getAttribute("data-webmvideo"),f=t.getAttribute("data-iframevideo"),y="";if(s&&(y="youtube",u=t396_video__generateIframeSrc(s,r,"youtube"),a=t396_video__createIframe(u,r,"youtube"),r.isLazy||a.addEventListener("load",(function(){o.style.backgroundColor=""}))),l&&(y="vimeo",u=t396_video__generateIframeSrc(l,r,"vimeo"),a=t396_video__createIframe(u,r,"vimeo")),c&&(y="vkvideo",u=t396_video__generateIframeSrc(c,r,"vkvideo"),a=t396_video__createIframe(u,r,"vkvideo")),m&&(y="rutube",u=t396_video__generateIframeSrc(m,r,"rutube"),a=t396_video__createIframe(u,r,"rutube")),v&&(y="kinescope",u=t396_video__generateIframeSrc(v,r,"kinescope"),a=t396_video__createIframe(u,r,"kinescope")),f&&(y="iframe",a=t396_video__createIframe(u=f,r,"iframe")),_&&(y="mp4"),p&&(y="webm"),_||p){var b=_||p;r.type="webm",_&&(r.type="mp4"),r.hasCover&&(r.isCoverFit=!0),a=t396_video__createVideoHTML(b,r);var h="display: flex; align-items: center;height:100%;";r.isCoverFit&&(h+="position: relative;"),t.style.cssText=h}if(r.hasCover)o.addEventListener("click",(function(){if(!o.querySelector("iframe, video")){a&&t.appendChild(a),o.style.backgroundImage="none";var e=o.querySelector(".tn-atom__video-play-link");e&&(e.style.display="none"),(_||p)&&a&&!o.processVideo&&(a.play(),o.processVideo=!0)}}));else{if(a&&t.appendChild(a),s&&r.isLazy&&t396_video__processYoutubeIframeBgOnLoad(o,a),_||p){var w=t.querySelector("video");t396_video__setLoaderForHTMLVideo(o,w,r.isCoverFit),t396_video__lazyLoadProcessHTMLVideo(w,r),w&&!r.isEditMode&&r.hiddenControls&&!r.hasAutoplay&&w.addEventListener("click",(function(){w.readyState<2||(w.paused?w.play():w.pause())}))}c&&r.isMuted&&(r.isLazy?t396_video__waitForLazyload(a,(function(){t396_video__muteVkVideo(t)})):t396_video__muteVkVideo(t))}t396__video__listenToVisibilityChange(t,y)}}function t396_video__waitForLazyload(e,t){if(e&&"MutationObserver"in window)if(e.src)t&&t();else{var o=new MutationObserver((function(i){i.forEach((function(i){"attributes"===i.type&&"src"===i.attributeName&&i.target.src&&e.addEventListener("load",(function(){t&&t(),o.disconnect()}))}))}));o.observe(e,{attributes:!0})}}function t396_video__processYoutubeIframeBgOnLoad(e,t){e&&t396_video__waitForLazyload(t,(function(){e.style.backgroundColor=""}))}function t396_video__generateIframeSrc(e,t,o){var i,n={youtube:"https://www.youtube.com/embed/",vimeo:"//player.vimeo.com/video/",vkvideo:"https://vk.com/video_ext.php",rutube:"https://rutube.ru/play/embed/",kinescope:"https://kinescope.io/embed/"}[o],r=n+e+"?";if("youtube"===o&&(t.hasInfo&&(r+="&showinfo=1"),t.hasLoop&&(r+="&loop=1&playlist="+e),t.startSec>0&&(r+="&start="+t.startSec),t.endSec>0&&(r+="&end="+t.endSec),t.isMuted&&(r+="&mute=1"),(t.hasCover||t.hasAutoplay&&!t.isEditMode)&&(r+="&autoplay=1",t.hasCover&&(r+="&amp;rel=0")),r+="&enablejsapi=1"),"vimeo"===o&&(r+="color=ffffff&badge=0",t.vimeoHash&&(t.vimeoHash=t.vimeoHash.trim(),r+=t.vimeoHash?"&h="+t.vimeoHash+"&":""),t.hasInfo?r+="&title=1&byline=1&portrait=1":r+="&title=0&byline=0&portrait=0",t.startSec>0&&(r+="#t="+t.startSec+"s"),t.endSec>0&&(r+="&end="+t.endSec+"s"),t.hasLoop&&(r+="&loop=1"),t.isMuted&&(r+="&muted=1"),(t.hasCover||t.hasAutoplay&&!t.isEditMode)&&(r+="&autoplay=1",r+="&autopause=false"),r+="&api=1"),"vkvideo"===o){var a=e.split("_"),u=a[0],d=a[1],s=a[2];r=n+"?oid="+u+"&id="+d+"&color=ffffff1&hd=2",s&&(r+="&hash="+s),t.startSec>0&&(r+="&t="+t.startSec+"s"),(t.hasCover||t.hasAutoplay&&!t.isEditMode)&&(r+="&autoplay=1"),t.isMuted&&(r+="&mute=1"),r+="&js_api=1"}return"rutube"===o&&(e.includes("?p=")&&(r=n+e),t.startSec>0&&(r+="&t="+t.startSec)),"kinescope"===o&&(t.startSec>0&&(r+="&t="+t.startSec),t.isMuted&&(r+="&muted=true"),(t.hasCover||t.hasAutoplay&&!t.isEditMode)&&(r+="&autoplay=true",r+="&autopause=false"),t.hasLoop&&(r+="&loop=true")),r}function t396_video__createIframe(e,t,o){var i=document.createElement("iframe"),n=o;return n+="-iframe-"+t.recid+"-"+t.elementID,i.id=n,i.width="100%",i.height="100%",i.frameBorder="0",i.allowFullscreen=!0,i.allow="autoplay; encrypted-media; fullscreen; picture-in-picture; screen-wake-lock;",!t.hasCover&&t.isLazy?(i.classList.add("t-iframe"),i.setAttribute("data-original",e)):i.src=e,t.hasCover&&(i.allow="autoplay"),i}function t396_video__createVideoHTML(e,t){var o=window.t396__isMobile&&window.isSafari&&!t.hasCover?"#t=0.001":"",i=e?'<source src="'+e+o+'" type="video/'+t.type+'">':"",n=document.createElement("video");return n.style.cssText="width: 100%;"+(t.hasCover?"":"display:none;")+(t.isCoverFit?"height: 100%; object-fit: cover; position: absolute;":"")+(t.hiddenControls&&!t.hasAutoplay?"cursor: pointer;":""),n.id="html-video-"+t.recid+"-"+t.elementID,n.innerHTML=i,t.hiddenControls||(n.controls=!0),!t.isEditMode&&t.hasAutoplay&&(n.autoplay=!0),t.isMuted&&(n.muted=!0),n.playsInline=!0,t.hasLoop&&(n.loop=!0),n}function t396_video__lazyLoadProcessHTMLVideo(e,t){var o;t.hasAutoplay&&!t.isEditMode&&e&&"IntersectionObserver"in window&&new IntersectionObserver((function(e){e.forEach((function(e){var t=e.target,o=function i(){t.removeEventListener("loadeddata",o),e.isIntersecting?t.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA&&t.play():t.pause()};t.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA?o():t.addEventListener("loadeddata",o)}))})).observe(e)}function t396_video__setLoaderForHTMLVideo(e,t,o){if(t){var i=/iPhone|iPad|iPod/i.test(navigator.userAgent)||"ontouchend"in document&&/Macintosh/.test(navigator.userAgent),n='background-image: url("https://tilda.ws/img/spinner-white.gif");';n+="background-repeat: no-repeat; background-position: center;",e.style.cssText+=n,t.addEventListener(i?"loadedmetadata":"canplay",(function(){e.style.backgroundImage="",o&&(e.style.backgroundColor=""),t.style.display="block"}))}}function t396__video__isVideoHidden(e){try{if(!e)return!1;var t;if("none"===window.getComputedStyle(e).display)return!0;for(var o=e.parentElement;o&&!o.classList.contains("t-rec");){var i;if("none"===window.getComputedStyle(o).display)return!0;o=o.parentElement}return!1}catch(n){return!1}}function t396__video__pauseVideo(e,t){if(e){var o=t_video__getPlayer(e);o?o.pause():t_videoPlayer__init(e,t).then((function(e){e.pause()})).catch((function(){console.warn("Could not pause zero video: "+t)}))}}function t396__video__listenToVisibilityChange(e,t){var o;e&&t&&"IntersectionObserver"in window&&new IntersectionObserver((function(e){e.forEach((function(e){!e.isIntersecting&&t396__video__isVideoHidden(e.target)&&t396__video__pauseVideo(e.target,t)}))})).observe(e)}function t396_video__muteVkVideo(e){if(e){var t=t_video__getPlayer(e);t?t.mute():t_videoPlayer__init(e,"vkvideo").then((function(e){e.mute()}))}}
